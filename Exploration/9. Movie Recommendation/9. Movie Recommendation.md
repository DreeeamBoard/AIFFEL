## Movielens 영화 추천 실습

-  MF 모델 학습 방법을 토대로, 내가 좋아할 만한 영화 추천 시스템을 제작해보자

### Movielens 데이터
- 유저가 영화에 대해 평점을 매긴 데이터가 데이터 크기별로 있습니다. MovieLens 1M Dataset 사용을 권장합니다.
- 별점 데이터는 대표적인 explicit 데이터입니다. 하지만 implicit 데이터로 간주하고 테스트해볼 수 있습니다.
- 별점을 시청횟수로 해석해서 생각하겠습니다.
- 또한 유저가 3점 미만으로 준 데이터는 선호하지 않는다고 가정하고 제외하겠습니다.

## 1. 데이터 준비와 전처리
- Movielens 데이터는 rating.dat 안에 이미 인덱싱까지 완료된 사용자-영화-평점 데이터가 깔끔하게 정리되어 있습니다.


```python
import os
import numpy as np
import pandas as pd

rating_file_path=os.getenv('HOME') + '/aiffel/recommendata_iu/data/ml-1m/ratings.dat'
ratings_cols = ['user_id', 'movie_id', 'rating', 'timestamp']
ratings = pd.read_csv(rating_file_path, sep='::', names=ratings_cols, engine='python', encoding = "ISO-8859-1")
original_data_size = len(ratings)

print(original_data_size) # 1,000,209
ratings.head()
```

    1000209





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>978302109</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>978301968</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>978300275</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>978824291</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 3점 이상만 남깁니다.

ratings = ratings[ratings['rating']>=3]
filtered_data_size = len(ratings) # 836,478

print(f'original_data_size: {original_data_size}, filtered_data_size: {filtered_data_size}')
print(f'Ratio of Remaining Data is {filtered_data_size / original_data_size:.2%}')
```

    original_data_size: 1000209, filtered_data_size: 836478
    Ratio of Remaining Data is 83.63%



```python
# rating 컬럼의 이름을 count로 바꿉니다.
# 별점을 시청횟수로 해석해서 생각하겠다고 하였으므로

ratings.rename(columns={'rating':'count'}, inplace=True)
ratings.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>count</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>978302109</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>978301968</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>978300275</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>978824291</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 영화 제목을 보기 위해 메타 데이터를 읽어옵니다.

movie_file_path=os.getenv('HOME') + '/aiffel/recommendata_iu/data/ml-1m/movies.dat'
cols = ['movie_id', 'title', 'genre'] 
movies = pd.read_csv(movie_file_path, sep='::', names=cols, engine='python', encoding='ISO-8859-1')

print(len(movies))
movies.head()
```

    3883





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_id</th>
      <th>title</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy Story (1995)</td>
      <td>Animation|Children's|Comedy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji (1995)</td>
      <td>Adventure|Children's|Fantasy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpier Old Men (1995)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale (1995)</td>
      <td>Comedy|Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II (1995)</td>
      <td>Comedy</td>
    </tr>
  </tbody>
</table>
</div>




```python
# ratings과 movies 합치기

ratings_join = ratings.join(movies.set_index('movie_id'), on='movie_id')
# set_index()함수는 데이터프레임을 불러온 후에, 특정 열을 인덱스로 설정
# on : 특정한 키값 기준

ratings_join.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>count</th>
      <th>timestamp</th>
      <th>title</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>978302109</td>
      <td>James and the Giant Peach (1996)</td>
      <td>Animation|Children's|Musical</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>978301968</td>
      <td>My Fair Lady (1964)</td>
      <td>Musical|Romance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>978300275</td>
      <td>Erin Brockovich (2000)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>978824291</td>
      <td>Bug's Life, A (1998)</td>
      <td>Animation|Children's|Comedy</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 불필요한 컬럼 제거
ratings_join = ratings_join.drop(columns=['timestamp', 'genre'])
ratings_join.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>count</th>
      <th>title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>James and the Giant Peach (1996)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>My Fair Lady (1964)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>Erin Brockovich (2000)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>Bug's Life, A (1998)</td>
    </tr>
  </tbody>
</table>
</div>



## 2. 분석


```python
# ratings에 있는 유니크한 영화 개수 : 3628
print(ratings_join['movie_id'].nunique())

# ratings에 있는 유니크한 title 개수 : 3628
print(ratings_join['title'].nunique())

# ratings에 있는 유니크한 사용자 수 : 6039
print(ratings_join['user_id'].nunique())
```

    3628
    3628
    6039



```python
# 인기 있는 영화 30개 (인기순)

movie_count = ratings_join.groupby('title')['user_id'].count()
movie_count.sort_values(ascending=False).head(50)
```




    title
    American Beauty (1999)                                   3211
    Star Wars: Episode IV - A New Hope (1977)                2910
    Star Wars: Episode V - The Empire Strikes Back (1980)    2885
    Star Wars: Episode VI - Return of the Jedi (1983)        2716
    Saving Private Ryan (1998)                               2561
    Terminator 2: Judgment Day (1991)                        2509
    Silence of the Lambs, The (1991)                         2498
    Raiders of the Lost Ark (1981)                           2473
    Back to the Future (1985)                                2460
    Matrix, The (1999)                                       2434
    Jurassic Park (1993)                                     2413
    Sixth Sense, The (1999)                                  2385
    Fargo (1996)                                             2371
    Braveheart (1995)                                        2314
    Men in Black (1997)                                      2297
    Schindler's List (1993)                                  2257
    Princess Bride, The (1987)                               2252
    Shakespeare in Love (1998)                               2213
    L.A. Confidential (1997)                                 2210
    Shawshank Redemption, The (1994)                         2194
    Godfather, The (1972)                                    2167
    Groundhog Day (1993)                                     2121
    E.T. the Extra-Terrestrial (1982)                        2102
    Being John Malkovich (1999)                              2066
    Ghostbusters (1984)                                      2051
    Pulp Fiction (1994)                                      2030
    Forrest Gump (1994)                                      2022
    Terminator, The (1984)                                   2019
    Toy Story (1995)                                         2000
    Fugitive, The (1993)                                     1941
    Alien (1979)                                             1920
    Gladiator (2000)                                         1798
    Total Recall (1990)                                      1786
    Star Wars: Episode I - The Phantom Menace (1999)         1783
    Usual Suspects, The (1995)                               1744
    Stand by Me (1986)                                       1728
    Blade Runner (1982)                                      1722
    Aliens (1986)                                            1720
    One Flew Over the Cuckoo's Nest (1975)                   1680
    Wizard of Oz, The (1939)                                 1650
    Godfather: Part II, The (1974)                           1624
    Casablanca (1942)                                        1623
    Who Framed Roger Rabbit? (1988)                          1605
    Bug's Life, A (1998)                                     1599
    Jaws (1975)                                              1598
    GoodFellas (1990)                                        1595
    Die Hard (1988)                                          1593
    Hunt for Red October, The (1990)                         1587
    Airplane! (1980)                                         1586
    Babe (1995)                                              1574
    Name: user_id, dtype: int64




```python
# 유저별 몇 편의 영화를 보는지에 대한 통계

user_count = ratings_join.groupby('user_id')['title'].count()
user_count.describe()
```




    count    6039.000000
    mean      138.512668
    std       156.241599
    min         1.000000
    25%        38.000000
    50%        81.000000
    75%       177.000000
    max      1968.000000
    Name: title, dtype: float64



## 3. 내가 선호하는 영화 5가지를 rating에 추가하자


```python
my_favorite = ['Toy Story (1995)', 'Back to the Future (1985)', 
               'Terminator, The (1984)', 'Men in Black (1997)', 'Jurassic Park (1993)']

#my_favorite_id = []
#for i in my_favorite:
#    my_favorite_id.extend(list(movies[movies['title'] == i]['movie_id']))

# 수동으로 추가하지 말고 위 코드 완성해보기!!!!


my_favorite_id = [2000, 2460, 2019, 2297, 2413]
```


```python
# 'dongsu'라는 user_id가 위 영화를 5회씩 시청했다고 가정
my_watchlist = pd.DataFrame({'user_id': ['dongsu']*5,'movie_id':my_favorite_id,
                             'count':[5]*5,'title': my_favorite})

my_watchlist
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>count</th>
      <th>title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>dongsu</td>
      <td>2000</td>
      <td>5</td>
      <td>Toy Story (1995)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>dongsu</td>
      <td>2460</td>
      <td>5</td>
      <td>Back to the Future (1985)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>dongsu</td>
      <td>2019</td>
      <td>5</td>
      <td>Terminator, The (1984)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>dongsu</td>
      <td>2297</td>
      <td>5</td>
      <td>Men in Black (1997)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>dongsu</td>
      <td>2413</td>
      <td>5</td>
      <td>Jurassic Park (1993)</td>
    </tr>
  </tbody>
</table>
</div>




```python
if not ratings_join.isin({'user_id':['dongsu']})['user_id'].any():  
    # user_id에 'dongsu'라는 데이터가 없다면
    ratings_join = ratings_join.append(my_watchlist,ignore_index=True)                          
    # 위에 임의로 만든 my_favorite 데이터를 추가해 줍니다. 
    # ignore_index=True를 안해주면 dongsu 데이터가 0,1,2,3,4 이렇게 들어간다

ratings_join.tail(10)       # 잘 추가되었는지 확인
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>count</th>
      <th>title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>836473</th>
      <td>6040</td>
      <td>1090</td>
      <td>3</td>
      <td>Platoon (1986)</td>
    </tr>
    <tr>
      <th>836474</th>
      <td>6040</td>
      <td>1094</td>
      <td>5</td>
      <td>Crying Game, The (1992)</td>
    </tr>
    <tr>
      <th>836475</th>
      <td>6040</td>
      <td>562</td>
      <td>5</td>
      <td>Welcome to the Dollhouse (1995)</td>
    </tr>
    <tr>
      <th>836476</th>
      <td>6040</td>
      <td>1096</td>
      <td>4</td>
      <td>Sophie's Choice (1982)</td>
    </tr>
    <tr>
      <th>836477</th>
      <td>6040</td>
      <td>1097</td>
      <td>4</td>
      <td>E.T. the Extra-Terrestrial (1982)</td>
    </tr>
    <tr>
      <th>836478</th>
      <td>dongsu</td>
      <td>2000</td>
      <td>5</td>
      <td>Toy Story (1995)</td>
    </tr>
    <tr>
      <th>836479</th>
      <td>dongsu</td>
      <td>2460</td>
      <td>5</td>
      <td>Back to the Future (1985)</td>
    </tr>
    <tr>
      <th>836480</th>
      <td>dongsu</td>
      <td>2019</td>
      <td>5</td>
      <td>Terminator, The (1984)</td>
    </tr>
    <tr>
      <th>836481</th>
      <td>dongsu</td>
      <td>2297</td>
      <td>5</td>
      <td>Men in Black (1997)</td>
    </tr>
    <tr>
      <th>836482</th>
      <td>dongsu</td>
      <td>2413</td>
      <td>5</td>
      <td>Jurassic Park (1993)</td>
    </tr>
  </tbody>
</table>
</div>



## 4. CSR matrix 만들기

### 4-1) 먼저 Indexing (user와 movie 각각에 번호를 붙이자)


```python
# 고유한 유저, 영화를 찾아내는 코드
user_unique = ratings_join['user_id'].unique()
movie_unique = ratings_join['title'].unique()

# 유저, 영화 indexing 하는 코드 idx는 index의 약자입니다.
user_to_idx = {v:k for k,v in enumerate(user_unique)}
movie_to_idx = {v:k for k,v in enumerate(movie_unique)}

# 인덱싱이 잘 되었는지 확인

print(user_to_idx['dongsu'])    
# 총 6039 + 1명의 유저 중 마지막으로 추가된 유저이니 6039

print(movie_to_idx['Back to the Future (1985)'])
print(movie_to_idx['Men in Black (1997)'])
print(movie_to_idx['Welcome to the Dollhouse (1995)'])
```

    6039
    22
    175
    311



```python
# indexing을 통해 데이터 컬럼 내 값을 바꾸는 코드
# dictionary 자료형의 get 함수는 https://wikidocs.net/16 을 참고하세요.

# user_to_idx.get을 통해 user_id 컬럼의 모든 값을 인덱싱한 Series를 구해 봅시다. 
# 혹시 정상적으로 인덱싱되지 않은 row가 있다면 인덱스가 NaN이 될 테니 dropna()로 제거

temp_user_data = ratings_join['user_id'].map(user_to_idx.get).dropna()

if len(temp_user_data) == len(ratings_join):   # 모든 row가 정상적으로 인덱싱되었다면
    print('user_id column indexing OK!!')
    ratings_join['user_id'] = temp_user_data   
    # raintgs_join['user_id']을 인덱싱된 Series로 교체해 줍니다. 
else:
    print('Fail!')

# movie_to_idx을 통해 title 컬럼도 동일한 방식으로 인덱싱해 줍니다. 
temp_movie_data = ratings_join['title'].map(movie_to_idx.get).dropna()

if len(temp_movie_data) == len(ratings_join):
    print('title column indexing OK!!')
    ratings_join['title'] = temp_movie_data
else:
    print('Fail!')

ratings_join.tail(10)
```

    user_id column indexing OK!!
    title column indexing OK!!





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>count</th>
      <th>title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>836473</th>
      <td>6038</td>
      <td>1090</td>
      <td>3</td>
      <td>1030</td>
    </tr>
    <tr>
      <th>836474</th>
      <td>6038</td>
      <td>1094</td>
      <td>5</td>
      <td>986</td>
    </tr>
    <tr>
      <th>836475</th>
      <td>6038</td>
      <td>562</td>
      <td>5</td>
      <td>311</td>
    </tr>
    <tr>
      <th>836476</th>
      <td>6038</td>
      <td>1096</td>
      <td>4</td>
      <td>142</td>
    </tr>
    <tr>
      <th>836477</th>
      <td>6038</td>
      <td>1097</td>
      <td>4</td>
      <td>26</td>
    </tr>
    <tr>
      <th>836478</th>
      <td>6039</td>
      <td>2000</td>
      <td>5</td>
      <td>40</td>
    </tr>
    <tr>
      <th>836479</th>
      <td>6039</td>
      <td>2460</td>
      <td>5</td>
      <td>22</td>
    </tr>
    <tr>
      <th>836480</th>
      <td>6039</td>
      <td>2019</td>
      <td>5</td>
      <td>200</td>
    </tr>
    <tr>
      <th>836481</th>
      <td>6039</td>
      <td>2297</td>
      <td>5</td>
      <td>175</td>
    </tr>
    <tr>
      <th>836482</th>
      <td>6039</td>
      <td>2413</td>
      <td>5</td>
      <td>107</td>
    </tr>
  </tbody>
</table>
</div>



### 4-2) 이제 CSR Matrix 생성


```python
from scipy.sparse import csr_matrix

# CSR Matrix 생성
num_user = ratings_join['user_id'].nunique()
num_movie = ratings_join['title'].nunique()

csr_data = csr_matrix((ratings_join['count'], (ratings_join.user_id, ratings_join.title)), shape= (num_user, num_movie))
csr_data
```




    <6040x3628 sparse matrix of type '<class 'numpy.longlong'>'
    	with 836483 stored elements in Compressed Sparse Row format>



## 5. AlternatingLeastSquares(ALS) 모델로 훈련

- Matrix Factorization에서 쪼개진 두 Feature Matrix를 한꺼번에 훈련하는 것은 잘 수렴하지 않기 때문에, 한쪽을 고정시키고 다른 쪽을 학습하는 방식을 번갈아 수행하는 AlternatingLeastSquares 방식이 효과적


```python
from implicit.als import AlternatingLeastSquares
import os
import numpy as np

# implicit 라이브러리에서 권장하고 있는 부분입니다. 학습 내용과는 무관합니다.
os.environ['OPENBLAS_NUM_THREADS']='1'
os.environ['KMP_DUPLICATE_LIB_OK']='True'
os.environ['MKL_NUM_THREADS']='1'
```


```python
# Implicit AlternatingLeastSquares 모델의 선언
als_model = AlternatingLeastSquares(factors=500, regularization=0.01, use_gpu=False, iterations=15, dtype=np.float32)
```


```python
# als 모델은 input으로 (item X user 꼴의 matrix를 받기 때문에 Transpose해줍니다.)
csr_data_transpose = csr_data.T
csr_data_transpose
```




    <3628x6040 sparse matrix of type '<class 'numpy.longlong'>'
    	with 836483 stored elements in Compressed Sparse Column format>




```python
# 모델 훈련
als_model.fit(csr_data_transpose)
```


      0%|          | 0/15 [00:00<?, ?it/s]


## 6. 훈련된 모델이 예측한 나의 선호도를 파악
- 내가 선호하는 5가지 영화 중 하나와 그 외의 영화 하나를 골라보자


```python
# 훈련된 모델이 만든 나의 벡터와 영화 벡터 구하기
dongsu, Back_to_the_Future = user_to_idx['dongsu'], movie_to_idx['Back to the Future (1985)']
dongsu_vector, Back_to_the_Future_vector = als_model.user_factors[dongsu], als_model.item_factors[Back_to_the_Future]
```


```python
dongsu_vector
```




    array([-3.12310457e-01, -4.19084817e-01, -4.44522537e-02, -5.13178147e-02,
            1.34196728e-01,  4.76826355e-02, -9.82380435e-02,  2.83794967e-03,
            5.40056944e-01, -5.64849198e-01, -1.52783900e-01,  5.00650220e-02,
            8.51895884e-02, -4.45072763e-02,  4.69121158e-01,  3.20437014e-01,
            1.55625463e-01, -6.53444469e-01,  2.00069219e-01,  3.46370965e-01,
           -8.44782442e-02, -2.65439361e-01, -1.88110054e-01,  5.36359437e-02,
            2.54559815e-01, -1.90702155e-01, -1.86468497e-01,  5.15397191e-01,
            1.05196811e-01,  1.05166361e-01, -2.25970611e-01, -1.62400424e-01,
            2.04340443e-01, -7.31754526e-02,  3.29665005e-01,  3.91866922e-01,
            3.57380778e-01, -3.72644722e-01,  7.42294192e-01,  2.73027927e-01,
           -4.10699457e-01, -2.57732004e-01, -1.79712474e-01,  1.78847954e-01,
            1.49572045e-01,  2.38436058e-01,  3.02543491e-01,  5.58423877e-01,
            1.65783882e-01,  1.96501404e-01, -3.95164378e-02, -2.22430915e-01,
            1.11463115e-01, -6.38983369e-01, -1.40158311e-01, -2.52983673e-03,
           -9.19175893e-02,  3.27078283e-01,  4.76130813e-01, -3.65086257e-01,
            1.24928273e-01,  4.39454615e-01,  1.30210161e-01,  2.05789041e-02,
           -7.25711048e-01, -6.59839809e-01,  4.51032937e-01, -3.88124079e-01,
           -1.03101365e-01, -4.39284325e-01,  1.91382077e-02,  5.42534478e-02,
            4.63717997e-01,  4.62426364e-01,  2.35965475e-01, -1.90281123e-02,
           -4.55580615e-02,  2.47346133e-01,  6.45302653e-01, -1.93399787e-01,
           -3.55552167e-01,  6.46558285e-01, -5.85174620e-01, -2.82857686e-01,
           -2.69722998e-01,  4.06220593e-02,  4.24154133e-01,  7.27732554e-02,
           -6.76513910e-02, -3.98055106e-01, -1.61057889e-01, -8.63200724e-02,
            7.49879956e-01, -3.86624821e-02, -3.04967016e-01,  8.55603993e-01,
           -2.83383518e-01,  1.08083054e-01, -6.59104347e-01, -9.27193820e-01,
            9.31876153e-02, -5.24189830e-01,  1.83891967e-01, -6.14927471e-01,
           -6.63510501e-01, -2.74074256e-01, -3.79766911e-01, -3.47026646e-01,
           -6.84969798e-02,  3.47476691e-01, -1.58747524e-01, -1.30624007e-02,
           -7.16642663e-02,  3.06881309e-01, -5.30867577e-01, -5.22736460e-02,
           -8.90807137e-02, -4.53340650e-01, -5.08046508e-01, -3.86170626e-01,
           -6.14933550e-01,  1.15125909e-01, -1.74456201e-02,  1.73032656e-01,
           -7.93104712e-03, -7.44428784e-02,  9.62236524e-02, -8.62189233e-02,
            3.78851518e-02, -5.55191375e-02, -1.72485083e-01, -1.02828652e-01,
            3.52218658e-01,  4.28105108e-02, -2.49030665e-01, -1.04003765e-01,
           -3.28840107e-01,  5.26143968e-01,  7.29656100e-01,  3.36062193e-01,
            3.65710884e-01,  5.18569350e-01,  1.31362885e-01, -2.06884667e-01,
           -2.13539317e-01,  3.01178366e-01,  3.99209291e-01,  1.93765506e-01,
           -2.31410369e-01,  2.51593560e-01,  1.98058158e-01, -1.53693020e-01,
            2.67130118e-02,  5.39103784e-02,  6.06051087e-01,  1.62996411e-01,
           -1.58460498e-01, -2.27352548e-02,  4.18272018e-01,  2.08881333e-01,
           -2.55639642e-01, -5.78487039e-01, -5.81686139e-01,  3.83046344e-02,
            3.01808178e-01,  2.27882937e-01, -1.06522487e-02,  2.04251796e-01,
           -2.09021240e-01, -7.32509136e-01,  2.38463074e-01,  9.25583020e-02,
            3.47165346e-01, -8.77427578e-01, -2.49186784e-01, -2.35572994e-01,
            4.51684207e-01, -5.01613081e-01, -1.63446188e-01,  6.18666410e-01,
            3.02113801e-01,  2.52164066e-01, -9.22777727e-02,  2.45553538e-01,
           -2.76071757e-01,  9.44151357e-02, -4.65111017e-01,  5.57003856e-01,
           -4.32651252e-01, -7.23278940e-01, -9.64428708e-02,  3.63140911e-01,
           -1.57908574e-01, -2.98595130e-01, -1.92283943e-01, -6.14009738e-01,
           -1.67454071e-02,  8.65063548e-01, -1.53434709e-01,  2.53777742e-01,
           -3.65184546e-01, -2.17636675e-01, -1.13444559e-01, -2.67772935e-02,
           -6.66172430e-02,  1.68519318e-01,  4.66134787e-01, -8.30461457e-02,
            3.68195206e-01,  3.22578065e-02, -2.55370647e-01,  7.67175481e-02,
           -4.42797355e-02, -3.04022189e-02, -1.22577824e-01,  1.87817961e-01,
           -4.74714845e-01, -2.58333951e-01, -1.25247866e-01, -2.02949151e-01,
            5.79898298e-01, -1.77044317e-01,  7.54846185e-02,  5.09043299e-02,
            4.28967774e-01,  7.63923466e-01, -1.36582196e-01,  5.66662550e-02,
            1.28360480e-01,  1.22926787e-01,  2.39425004e-01,  4.85677868e-01,
           -3.25051546e-01, -1.92087159e-01, -2.39980325e-01, -2.26313584e-02,
            2.76945326e-02,  4.02509645e-02, -9.88749981e-01, -5.80224335e-01,
           -7.79289603e-02,  1.70236841e-01, -4.71922569e-02,  4.41396505e-01,
           -2.45743141e-01,  1.07156359e-01,  3.40912193e-01, -3.67092609e-01,
           -1.85964346e-01, -2.37531483e-01,  1.35007396e-01,  2.02193767e-01,
            2.75206000e-01,  4.50238377e-01, -7.32300222e-01, -2.61479348e-01,
            4.62097019e-01, -5.69931924e-01,  1.12324916e-01,  9.27981660e-02,
            3.63679081e-02,  1.74466223e-02, -7.00948358e-01,  8.55060369e-02,
           -2.21447080e-01,  6.99715912e-01,  3.87071103e-01, -4.72255200e-02,
            5.45098782e-01, -7.41109252e-02, -7.58767068e-01, -1.30581647e-01,
           -2.92435646e-01, -2.57906258e-01,  1.83689982e-01, -8.68068561e-02,
            3.27770144e-01, -4.95652437e-01, -3.67352754e-01, -2.42435515e-01,
           -2.28874430e-01, -9.90387276e-02,  2.02413321e-01,  6.29084185e-02,
           -7.60992885e-01,  1.96705237e-01, -5.30501120e-02,  5.00691116e-01,
            2.35061333e-01,  2.74671048e-01, -1.50780514e-01,  2.54852951e-01,
           -7.57406354e-02,  2.34729797e-01,  1.34970814e-01,  2.61874050e-01,
           -2.21022397e-01, -2.35562287e-02, -8.26615915e-02,  2.84002870e-01,
           -1.80433095e-01, -8.36532116e-02, -2.67375022e-01,  5.73049337e-02,
           -3.48529369e-01,  4.84374702e-01,  5.78408301e-01,  5.69250107e-01,
           -6.28206506e-02,  4.81655002e-02, -3.04508567e-01,  3.49702239e-01,
            7.38609314e-01,  1.46020561e-01, -2.33337060e-02, -1.29567742e-01,
           -1.90978378e-01,  9.23310667e-02, -4.55287397e-01,  6.31967932e-02,
            1.33917928e-01, -4.30324972e-01,  2.00435698e-01, -8.63272250e-02,
           -3.54208261e-01,  1.15786803e+00, -1.32002488e-01, -1.23696677e-01,
           -3.33410680e-01,  2.57249534e-01,  2.73400337e-01, -1.37836874e-01,
            3.20763998e-02,  2.65135199e-01, -4.80897635e-01, -1.83341373e-02,
            3.08577627e-01,  2.25177571e-01,  6.21959209e-01,  8.82045478e-02,
           -2.91877925e-01, -7.10471794e-02,  4.37494397e-01,  1.99623808e-01,
            3.48207742e-01,  5.49504399e-01, -2.46177167e-01,  1.40129810e-03,
            1.69331238e-01, -1.57035112e-01,  2.15917915e-01,  9.87540185e-02,
           -6.46572560e-02, -1.67610366e-02, -4.41460311e-01,  9.59664881e-02,
           -1.77636698e-01,  1.60550490e-01, -7.42766336e-02,  2.60576576e-01,
            9.08539072e-02, -2.04911932e-01,  1.99481174e-01,  9.54910666e-02,
            3.13164651e-01,  7.45358914e-02,  3.14175397e-01,  4.77824777e-01,
           -7.74760664e-01,  1.40852094e-01, -4.52249721e-02, -3.38432848e-01,
           -2.35698909e-01,  2.76814342e-01, -1.34342298e-01,  2.39974223e-02,
            2.32786968e-01,  1.38531849e-01, -4.83560771e-01,  1.19380049e-01,
            6.17066920e-01, -5.70278347e-01,  3.88982892e-02,  2.78543621e-01,
            2.72312731e-01,  2.82883942e-01,  4.23409790e-01,  1.03612170e-02,
           -4.95581239e-01, -1.04582466e-01, -1.53401613e-01, -2.45147929e-01,
            1.33600637e-01, -1.07837066e-01,  9.11739618e-02,  2.96790272e-01,
            6.42974198e-01,  9.50415954e-02, -1.55434003e-02,  2.91885901e-02,
           -9.84419212e-02,  1.04209304e-01, -2.35227868e-01, -1.80768609e-01,
           -1.85297057e-01,  1.03337191e-01, -3.60720791e-02, -3.72873485e-01,
           -3.36450547e-01,  6.87637269e-01,  1.97962388e-01, -9.62780614e-04,
           -6.60260469e-02,  3.29311460e-01,  2.81081527e-01, -7.42722536e-03,
            2.80590653e-01, -3.00998956e-01, -3.79383922e-01,  2.99874455e-01,
           -8.93818364e-02,  2.39018295e-02, -5.80209970e-01,  1.36303410e-01,
           -5.75718641e-01, -2.63378531e-01,  1.04001686e-01,  1.43560946e-01,
            4.15322453e-01,  1.79880679e-01, -1.39941007e-01,  6.12922497e-02,
           -5.03031969e-01,  8.07948038e-02, -1.87147811e-01, -1.92018002e-01,
            2.64226109e-01,  3.43921363e-01, -1.07803745e-02, -5.00609696e-01,
            2.15242118e-01, -4.66491014e-01, -2.04279244e-01, -1.72811896e-02,
           -9.02098939e-02, -6.01919442e-02, -2.06203699e-01, -1.74858019e-01,
           -7.38151968e-01, -2.29763642e-01, -1.95937634e-01, -1.99795216e-02,
            4.84318256e-01,  6.07464239e-02,  1.75482735e-01, -1.82757363e-01,
           -3.09495687e-01, -5.42826056e-02, -4.97707538e-02, -1.55462055e-02,
            5.71143031e-01,  3.63896906e-01,  3.57139945e-01, -3.93310606e-01,
            1.80034209e-02,  1.74321726e-01, -3.25557321e-01, -1.57101806e-02,
           -1.69356823e-01,  7.37384140e-01, -1.07857816e-01,  2.10965559e-01,
            1.87801663e-02,  2.01798052e-01, -5.60692430e-01, -3.95002246e-01,
           -1.25087470e-01, -1.21484704e-01, -2.40299385e-03, -5.67849725e-02,
           -3.70891303e-01,  1.03546046e-01,  2.40954697e-01,  1.73446521e-01,
           -7.86736831e-02,  1.02029413e-01,  3.02641541e-01,  1.81487739e-01,
            2.58812100e-01, -4.27897945e-02,  1.63662180e-01,  2.23030165e-01,
           -2.03561619e-01,  8.34199637e-02,  3.61404754e-02, -2.36832991e-01,
           -1.20936520e-02, -5.24284601e-01,  5.10612130e-01,  2.10196637e-02],
          dtype=float32)




```python
Back_to_the_Future_vector
```




    array([ 2.27214377e-02, -1.82961244e-02,  2.04685945e-02,  8.56131781e-03,
            1.95140354e-02,  1.93073209e-02,  6.00653095e-03,  1.45004522e-02,
            2.00650338e-02,  4.43194946e-03, -1.28159029e-02,  1.31417643e-02,
            3.90539831e-03,  7.91795924e-03,  1.55167561e-02,  1.46239586e-02,
            8.62338487e-03, -1.55058568e-02,  7.14797899e-03, -1.17784869e-02,
           -6.75743911e-03,  2.40718364e-03,  4.98093432e-03, -7.81469140e-03,
            1.76197756e-02, -8.46021622e-03,  1.33181568e-02,  1.66798178e-02,
           -1.29152625e-03, -7.77895376e-03,  9.87325143e-03, -2.96808756e-03,
            5.24362689e-03,  1.57854427e-02,  6.31378079e-03,  1.99088641e-02,
           -8.21029674e-03, -1.63134392e-02,  1.48261432e-02, -1.71894603e-03,
           -1.92577858e-02,  1.63067551e-03, -5.54975169e-03,  8.28233361e-03,
            2.13964488e-02,  2.20661145e-02,  1.45242475e-02,  2.82148961e-02,
           -4.92433412e-03,  9.83525533e-03,  8.06388725e-03, -8.60640965e-03,
           -2.17577815e-03,  6.21989882e-03, -3.45109147e-03, -4.90863575e-03,
            6.89181266e-03, -4.82571498e-03,  1.27019901e-02,  2.48080189e-03,
            2.06553768e-02,  5.56055224e-03,  5.67539502e-03,  9.43082664e-03,
           -8.32410250e-03, -1.19494880e-02,  1.20667936e-02,  2.35145446e-03,
            4.24945401e-03, -3.70466500e-04,  4.04614350e-03, -8.77952017e-03,
           -1.00794213e-03, -2.91846669e-03,  1.92905143e-02, -1.01126800e-03,
           -1.20165315e-03,  9.47689451e-03,  4.22159657e-02, -5.37964795e-03,
           -1.43241184e-02,  1.04865674e-02, -1.83948483e-02, -9.80901718e-03,
            5.99785883e-04, -1.30981524e-02,  3.80341895e-03, -8.78514984e-05,
            1.52695226e-02, -6.26962446e-03,  5.31180063e-03,  4.21224628e-03,
            1.27317393e-02, -1.19686257e-02,  7.85046723e-03,  2.68828701e-02,
           -5.11020888e-03,  1.36274714e-02, -5.51259378e-03, -7.51902629e-03,
            1.76476575e-02, -1.72852967e-02, -4.78856935e-04, -1.11793326e-02,
           -2.26824619e-02, -2.35250266e-03, -3.04635061e-04, -9.52405110e-03,
            2.44846009e-02,  8.75347573e-03, -6.43789209e-03, -3.66352592e-03,
           -3.60579090e-03,  3.39008570e-02,  4.49326495e-03, -4.11154609e-03,
            5.72778797e-03, -2.67550233e-03, -2.24898173e-03,  6.77586533e-03,
            1.28251817e-02,  5.67953195e-03,  1.71106253e-02,  2.01256927e-02,
           -1.68790238e-03,  1.77135300e-02,  9.88592021e-03,  2.93898527e-02,
            1.71198323e-02,  1.71764437e-02,  1.01991859e-03,  1.35768224e-02,
           -1.41950150e-03,  4.06736450e-04,  1.83690973e-02,  7.04337377e-03,
           -2.01697964e-02,  1.30726525e-03,  1.12743378e-02,  1.39727816e-02,
            7.26199616e-03,  1.45541895e-02,  1.52408807e-02,  1.03265392e-02,
            2.51891324e-03, -7.02739228e-03,  6.83535589e-04,  4.27579973e-03,
           -5.99684427e-03,  1.73471812e-02,  8.69955681e-03,  1.39773367e-02,
           -6.89803623e-03, -7.42465444e-03,  1.12113673e-02,  5.35462983e-04,
            9.41315945e-03, -2.04600440e-03,  1.08070206e-02, -9.46124736e-03,
           -4.55360347e-03, -4.66795918e-03, -9.86431539e-03, -3.12265853e-04,
            1.26105053e-02,  1.30832689e-02,  4.02120641e-03, -2.99933902e-03,
            1.77540444e-02, -1.63374320e-02,  8.59046075e-03,  2.02263333e-02,
            1.86626334e-02, -1.15611712e-02,  6.18729647e-03, -6.90837903e-03,
            1.90681312e-02,  1.50694943e-03, -1.09099094e-02,  1.13496874e-02,
           -7.65771698e-03,  1.02106584e-02, -1.11552933e-02,  2.37983111e-02,
           -1.23860072e-02,  1.15913199e-02, -1.51153831e-02, -1.58971176e-02,
           -1.73897818e-02, -1.79001018e-02, -5.87783474e-03,  1.51522411e-02,
           -2.02694000e-03, -1.98148354e-03, -9.11249593e-03, -9.71016381e-03,
            1.76987629e-02,  2.33961083e-02,  1.31546091e-02,  4.66899201e-03,
            6.71900064e-03, -7.18737952e-04, -1.38008576e-02, -1.03206532e-02,
            3.15216486e-03,  2.87241917e-02,  4.15113904e-02,  1.20347925e-02,
           -5.00228349e-03,  1.88213531e-02, -7.13987043e-03,  1.10364985e-02,
           -9.21197981e-03,  4.00424609e-03, -2.14982103e-03, -8.72413977e-04,
           -1.47084035e-02,  8.43254908e-04, -1.28196431e-02,  1.02673294e-02,
            2.98536364e-02, -1.33573245e-02,  1.83086880e-02, -2.81995791e-03,
            1.10810641e-02,  1.60604082e-02,  7.54541776e-04, -7.52522785e-04,
            2.90211421e-02,  8.24334379e-03, -8.59142840e-03,  4.81980341e-03,
           -2.21181344e-02, -1.53709222e-02,  1.00636408e-02, -5.39756753e-03,
           -1.38047636e-02,  1.44268256e-02,  1.76346805e-02,  4.58203070e-03,
            7.62833515e-03,  3.51704918e-02, -7.74832442e-03,  5.94565179e-03,
           -1.63475350e-02, -4.74797562e-03,  1.26326913e-02,  1.11267520e-02,
            8.13898910e-03,  6.51581818e-03, -2.25073844e-03,  1.06028896e-02,
           -3.75271705e-03, -6.75043033e-04, -3.13833472e-03, -2.20533963e-02,
            2.28181873e-02, -8.32137279e-03, -1.75737608e-02,  2.79971268e-02,
           -4.59664734e-03, -2.75170361e-03, -1.38894022e-02,  1.78520437e-02,
           -6.65244646e-03,  1.92695670e-02,  2.67926175e-02,  9.58824903e-03,
            1.34088537e-02,  1.13576381e-02, -4.77621611e-03, -1.36974957e-02,
           -1.26829697e-02,  2.15044934e-02,  1.78224146e-02, -4.12005698e-03,
            2.40883585e-02, -1.27780018e-04,  4.33415500e-03,  4.34750877e-03,
            6.87997369e-03, -4.05211002e-03,  2.37906035e-02,  1.80824697e-02,
           -6.79832604e-03,  1.66063644e-02,  9.49808955e-03,  1.25804162e-02,
            6.74636289e-03,  1.29135288e-02, -4.20197938e-03,  2.75181662e-02,
            1.18789272e-02,  9.58670862e-03, -8.98667704e-03,  2.67808549e-02,
            3.92835541e-03, -2.43708049e-03, -7.68602733e-03,  4.02610004e-03,
            2.19930690e-02,  2.59848014e-02,  3.53203760e-03, -4.46498953e-03,
            6.05486939e-03,  2.50991490e-02,  7.48753222e-03,  1.50150228e-02,
            7.78511213e-03, -1.40559245e-02, -2.91391625e-04,  9.06225760e-03,
            3.01552452e-02, -4.70062252e-03, -1.07212299e-02,  8.53089336e-03,
           -6.83565391e-03, -1.17915764e-03,  1.19164074e-02,  3.74026317e-03,
            1.71120686e-03, -1.67130642e-02,  1.25311827e-02, -4.39285720e-03,
           -8.71035736e-03,  2.68764701e-02,  9.99492407e-03,  6.75983075e-03,
           -2.89567676e-03, -6.55550789e-03,  1.00514414e-02,  2.08633877e-02,
            1.53933316e-02,  3.46570387e-02, -5.81515348e-03,  1.92679837e-02,
            2.36805268e-02,  1.74685046e-02,  1.82026194e-03, -7.99272116e-03,
            6.24941289e-03, -9.78735276e-03, -8.02982505e-03, -1.01196663e-02,
            1.45023707e-02,  2.28254516e-02, -4.39815084e-03,  1.47368489e-02,
            1.01061892e-02,  1.45544186e-02, -1.14095658e-02, -1.11200511e-02,
            2.99356058e-02, -5.41639794e-03, -6.61281543e-03, -1.85837038e-02,
            2.00928561e-02,  4.65107942e-03,  9.22379084e-03, -1.42918632e-03,
           -3.62957548e-03,  9.19240352e-04,  8.23025405e-03,  1.75352499e-03,
            2.72177570e-02,  1.67192779e-02,  3.04684564e-02,  2.91543221e-03,
            4.48990986e-03, -1.70704490e-03,  1.30707445e-02, -1.31852003e-02,
            2.51365849e-03,  2.42587347e-02,  3.96015029e-03,  7.73690781e-03,
            1.36377411e-02,  2.69172583e-02, -2.19769906e-02,  1.60710642e-03,
           -8.20792373e-03, -8.48815963e-03, -1.01627372e-02, -7.90537987e-03,
            1.66740024e-03, -1.51121076e-02,  7.65486155e-03,  1.83137357e-02,
           -2.26297565e-02,  1.10540248e-03,  1.95502816e-03,  1.24667278e-02,
            2.56561525e-02, -6.12914981e-03, -1.23224761e-02,  2.05185171e-02,
            2.51132157e-02,  2.03405991e-02,  1.18623562e-02, -6.79841125e-03,
            7.75211724e-03,  2.01536734e-02,  5.46638342e-03,  6.63849385e-03,
            4.02537826e-03,  3.11238505e-03, -1.57490633e-02,  1.36450147e-02,
           -1.53788831e-02,  1.94393452e-02,  1.48652596e-02,  1.86361335e-02,
            1.06967930e-02,  1.23019088e-02,  2.67980844e-02,  1.79486088e-02,
            1.64626874e-02, -5.82758104e-03, -7.15838093e-03, -3.82800674e-04,
            4.99984808e-03,  3.03030421e-04, -1.27501516e-02,  7.61217903e-03,
           -1.24997180e-03, -1.33890398e-02,  3.26444628e-03,  1.61098614e-02,
            1.80440936e-02,  3.15141939e-02, -1.63592286e-02,  7.41652120e-03,
           -8.48476496e-03,  1.07531101e-02,  3.24655995e-02,  1.15278433e-03,
           -1.04614580e-03,  4.54797730e-04,  1.24284271e-02,  1.10681430e-02,
            1.79651529e-02,  9.18216445e-03,  2.03717817e-02,  1.43888956e-02,
           -1.59795885e-03,  1.47507770e-03,  9.01462696e-03,  1.40343262e-02,
           -1.09941373e-02, -1.33498060e-03, -7.25154672e-03,  1.52335782e-02,
            3.13186049e-02,  4.13849996e-03,  1.37326159e-02, -8.47738585e-04,
            1.32681718e-02, -1.56513359e-02, -2.94338190e-03,  1.55976107e-02,
            1.25836115e-02,  1.96866728e-02,  1.45234289e-02,  4.26729117e-03,
           -3.40577913e-03,  7.68048782e-03, -1.82611030e-03,  3.52081587e-03,
            2.05516163e-02,  2.11276803e-02,  1.21934349e-02,  1.09185176e-02,
            9.61286481e-03,  2.40728203e-02, -5.16748102e-03, -1.20631820e-02,
            1.05228992e-02,  1.76441986e-02, -1.63384173e-02, -5.38501656e-03,
            1.13423290e-02, -1.99923702e-02,  1.34731457e-02,  1.68366842e-02,
           -4.70744213e-03,  2.22254056e-03,  1.44835450e-02,  1.91863589e-02,
            1.62096135e-02,  1.04345931e-02,  2.41411030e-02, -5.05201193e-03,
           -6.56534312e-03,  1.17629012e-02, -1.47688612e-02,  1.07050575e-02,
            6.12346875e-03, -7.03149848e-03,  2.06685849e-02,  5.24871005e-03],
          dtype=float32)




```python
# 선호하는 영화
print(np.dot(dongsu_vector, Back_to_the_Future_vector))

# 선호하지 않는 영화
Two_Family_House = movie_to_idx['Two Family House (2000)']
Two_Family_House_vector = als_model.item_factors[Two_Family_House]
print(np.dot(dongsu_vector, Two_Family_House_vector))
```

    0.947458
    0.0073941057


### Back to the Future 내적값은 1이 나오는 것이 이상적이다!

### AlternatingLeastSquares 클래스의 init 파라미터를 변경해봐야겠다

- factors : 유저와 아이템의 벡터를 몇 차원으로 할 것인지
- regularization : 과적합을 방지하기 위해 정규화 값을 얼마나 사용할 것인지
- use_gpu : GPU를 사용할 것인지
- iterations : epochs와 같은 의미입니다. 데이터를 몇 번 반복해서 학습할 것인지

## 7. 내가 좋아하는 영화와 비슷한 영화를 추천받아 보자

- AlternatingLeastSquares 클래스에 구현되어 있는 similar_items 메서드 이용


```python
# 내가 좋아하는 영화를 입력하면 비슷한 영화를 추천해주는 함수

def get_similar_movie(movie_name: str):
    movie_id = movie_to_idx[movie_name]
    similar_movie = als_model.similar_items(movie_id, N=15)
    
    # movie_to_idx 를 뒤집어, index로부터 movie 이름을 얻는 dict를 생성
    idx_to_movie = {v:k for k,v in movie_to_idx.items()}
    similar_movie = [idx_to_movie[i[0]] for i in similar_movie]
    return similar_movie
```


```python
get_similar_movie('Jaws (1975)')
```




    ['Jaws (1975)',
     'Alien (1979)',
     'Exorcist, The (1973)',
     'Rocky (1976)',
     'Butch Cassidy and the Sundance Kid (1969)',
     'Shining, The (1980)',
     'Carrie (1976)',
     'Psycho (1960)',
     'Young Frankenstein (1974)',
     'Goldfinger (1964)',
     'Halloween (1978)',
     'Jaws 2 (1978)',
     'Raiders of the Lost Ark (1981)',
     'Birds, The (1963)',
     'Omen, The (1976)']



## 8. 내가 가장 좋아할 만한 영화들을 추천받아 보자
- AlternatingLeastSquares 클래스에 구현되어 있는 recommend 메서드를 통하여 제가 좋아할 만한 아티스트를 추천받아보자.


```python
user = user_to_idx['dongsu']
# recommend에서는 user*item CSR Matrix를 받습니다.
movie_recommended = als_model.recommend(user, csr_data, N=20, filter_already_liked_items=True)
# filter_already_liked_items 는 유저가 이미 평가한 아이템은 제외하는 Argument입니다.
idx_to_movie = {v:k for k,v in movie_to_idx.items()}
[idx_to_movie[i[0]] for i in movie_recommended]
```




    ['Terminator 2: Judgment Day (1991)',
     'Aliens (1986)',
     'League of Their Own, A (1992)',
     'Toy Story 2 (1999)',
     'Back to the Future Part II (1989)',
     'Shining, The (1980)',
     'Big (1988)',
     'Die Hard (1988)',
     'Bull Durham (1988)',
     'Lost World: Jurassic Park, The (1997)',
     'Gone with the Wind (1939)',
     'Pretty Woman (1990)',
     'Robocop (1987)',
     'Alien (1979)',
     'Little Mermaid, The (1989)',
     'Austin Powers: International Man of Mystery (1997)',
     'Clockwork Orange, A (1971)',
     'James and the Giant Peach (1996)',
     'Mission: Impossible (1996)',
     'Vacation (1983)']




```python
# AlternatingLeastSquares 클래스에 구현된 explain 메소드 ->
# user가 기록을 남긴 데이터 중 특정 영화 추천에 기여한 정도를 확인

recommended = movie_to_idx['Matrix, The (1999)']
explain = als_model.explain(user, csr_data, itemid=recommended)

[(idx_to_movie[i[0]], i[1]) for i in explain[1]]
```




    [('Toy Story (1995)', 0.02330447324562452),
     ('Back to the Future (1985)', 0.016540859133562787),
     ('Jurassic Park (1993)', 0.01480807982265588),
     ('Men in Black (1997)', 0.013307078899506318),
     ('Terminator, The (1984)', 0.0005624468894453346)]



## 회고

1. ratings과 movie를 병합하는 과정에서 많이 해맸다. LMS 조원들의 도움으로 해결할 수 있었다. join을 활용했다.

2. AlternatingLeastSquares 클래스의 init 파라미터 중 하나인 factors를 100 -> 200으로 변경했더니 성능이 훨씬 좋아졌다.

3. Matrix Factorization, CSR(Compressed Sparse Row) Matrix 개념이 매우 신기했다. 공부하면서 감탄했다. 세상엔 똑똑한 사람들이 정말 많구나
